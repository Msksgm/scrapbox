# 0118\_「セキュア・バイ・デザイン」 読書 継続 391 日

# 第１２章 レガシー・コードへの適用

ドメイン・プリミティブは完結した概念（Conceptual Whole）を形成しなくてはならない

曖昧な引数の問題に対処するアプローチ

- 直接的なアプローチ
- 検出によるアプローチ
- 新しい API を使ったアプローチ

「過保護な実装」によって、何度も null を確認するようなコードは、セキュアではないし、DRY 原則に反している

DRY 原則の誤解

「すべての知識はシステム内において、単一、かつ明確な、そして信頼できる表現になっていなければならない」
は勘違いされがちである。

偽陽性（false positive）、偽陰性（false negative）が起こりうる

偽陽性は、たまたま同じ処理を行う違う処理が実行されること、結合度の高い実装になる

偽陰性は、同じ処理を違う記述をしてしまうこと

ドメイン固有の型における不十分な妥当性確認。ドメインエキスパートとともにドメインの精度を高める

不完全なドメイン・プリミティブとは、ドメイン・プリミティブが完結した概念として完全に捉えきれていないとき

隠れた問題が存在するケース

- DRY 原則の間違った適用
- 妥当性確認が十分に行われていないドメイン固有の型
- 異常値や極端値のテストが欠落しているコード

訂正が難しい２つの落とし穴

- ドメイン・プリミティブを使わないことで起こる問題
- 不完全なドメイン・プリミティブによる危険性
